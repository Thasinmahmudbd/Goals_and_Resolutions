<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Functions page</title>
</head>
<body>
    
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!--connecting database-->
<?php include"database_connection_inc.php"; ?>
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<?php 
// Function to store post data in database.
function setGoals() {
global $connection; 
    
if(isset($_POST['set'])){
    
    // Getting data from form and storing in variables (with SQL injection).
    $goals = mysqli_real_escape_string( $connection, $_POST['goals'] );
    date_default_timezone_set('Asia/Dhaka');
    $posting_date = date("F j, Y, g:i a");
  
    // Form data insertion in Database: goals_and_resolutions, Table name: goals_table.
               
        //Data insertion.
        $insert_post_data = "INSERT INTO goals_table (goals, date) ";
        $insert_post_data .= " VALUES ('$goals' , '$posting_date');";
                        
        mysqli_query($connection, $insert_post_data);
        
        header("Location: index.php");

    }      
}
?>
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<?php 
// Function to show goals that are stored in database.
function showGoals() {
global $connection; 
        
        //Data read.
        $read_post_data = "SELECT * FROM goals_table ORDER BY goals_id DESC;";
    
        $result = mysqli_query($connection, $read_post_data);
        
        while($row = mysqli_fetch_assoc($result)) {
            
            $post = $row['goals'];
            $post_date = $row['date'];

//post template
    echo "<div class='posts'>";

    echo    "<div class='date'>";
    echo        "<p>$post_date</p>";
    echo    "</div>";

    echo    "<div class='goals'>";
    echo        "<p>$post</p>";
    echo    "</div>";

    echo    "<div class='goals_status'>";
    echo        "<form action='index.html' method='post'>";
    echo            "<button class='complete_btn' type='submit' name='completed'>Goal <br>Achived</button>";
    echo        "</form>";
    echo    "</div>";

    echo "</div>";


        }
}
?>
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
<!---------------------------------------------------------------------------------------------------->
</body>
</html>